function jel(){var elParent=this===window?document.body:this;return elParent.jel.apply(elParent,arguments)}jel.settings={},jel.settings.allowScripts=!0,jel.settings.mapKeywords={innerHTML:"innerHTML",html:"html",children:"children",chi:"chi",properties:"properties",prop:"prop",jel:"jel"},jel._templates={},jel.SetTemplate=function(strTemplateName,jelTemplate){return"string"!=typeof strTemplateName||"function"!=typeof jelTemplate&&"object"!=typeof jelTemplate&&"string"!=typeof jelTemplate?void 0:(this._templates[strTemplateName]=jelTemplate,this)},jel.GetTemplate=function(strTemplateName){return this._templates[strTemplateName]},HTMLElement.prototype.jel=function(){function jelSetStyle(el,oStyle){if(Array.isArray(oStyle))for(var o=0;o<oStyle.length;o++)jelSetStyle(el,oStyle[o]);else if("function"==typeof oStyle)jelSetStyle(el,oStyle.call(el,el,el.style));else for(var o in oStyle){var newStyleProp;newStyleProp="function"==typeof oStyle[o]?oStyle[o].call(el,el,el.style[o]):oStyle[o],("string"!=typeof el.style[o]||-1==el.style[o].search("!important")||"string"==typeof newStyleProp&&-1!=newStyleProp.search("!important"))&&(el.style[o]=newStyleProp)}}function jelSetClass(el,oClass){if(Array.isArray(oClass))for(var o=0;o<oClass.length;o++)jelSetClass(el,oClass[o]);else{var strClass=el.getAttribute("class");strClass||(strClass=""),strClass="function"==typeof oClass?strClass+" "+oClass.call(el,el,strClass.trim()):strClass+" "+oClass,el.setAttribute("class",strClass.trim())}}function jelAddHTML(el,strHTML){if(jel.settings.allowScripts||-1==strHTML.search("<script"))return el.appendChild(document.createRange().createContextualFragment(strHTML))}function jelAddArray(el,arr,appliedTemplatesAttr){for(var rel in arr)void 0!==arr[rel].tagName?el.appendChild(arr[rel]):"object"==typeof arr[rel]?el.jel(arr[rel],{_appliedTemplates:appliedTemplatesAttr}):"function"==typeof arr[rel]&&arr[rel].call(el,el)}function jelAddPropertyLink(strTarget,strLocal){if("object"==typeof strLocal&&Array.isArray(strLocal))for(var l=0;l<strLocal.length;l++)jelAddPropertyLink.call(this,strTarget,strLocal[l]);else{var el=this._ownerElement,arTargetProp=strTarget.split("."),arLocalProp=strLocal.split("."),iterTarget=el.jelEx._namedParent;"root"===arTargetProp[0]&&(iterTarget=el.jelEx._componentRoot);for(var tp=1;tp<arTargetProp.length-1;tp++)void 0===iterTarget[arTargetProp[tp]]&&(iterTarget[arTargetProp[tp]]={}),iterTarget=iterTarget[arTargetProp[tp]];for(var iterLocal=el,lp=0;lp<arLocalProp.length-1;lp++){if(void 0===iterLocal[arLocalProp[lp]])throw"Invalid local property";iterLocal=iterLocal[arLocalProp[lp]]}!function(arTargetProp,iterTarget,arLocalProp,iterLocal){var strTargetPropName=arTargetProp[arTargetProp.length-1],strLocalPropName=arLocalProp[arLocalProp.length-1];void 0===iterTarget[strTargetPropName]&&(Object.defineProperty(iterTarget,strTargetPropName,{get:function(){var res=[],linkedProps=iterTarget.jelExt[strTargetPropName]._properties;for(var p in linkedProps)res.push(linkedProps[p].localPropParent[linkedProps[p].localPropName]);return 1===res.length&&(res=res[0]),res},set:function(newValue){var linkedProps=iterTarget.jelExt[strTargetPropName]._properties;for(var p in linkedProps)linkedProps[p].localPropParent[linkedProps[p].localPropName]=newValue}}),iterTarget.jelExt=iterTarget.jelExt||{},iterTarget.jelExt[strTargetPropName]={},iterTarget.jelExt[strTargetPropName]._properties=[]),iterTarget.jelExt[strTargetPropName]._properties.push({localPropParent:iterLocal,localPropName:strLocalPropName})}(arTargetProp,iterTarget,arLocalProp,iterLocal)}}function jelSetAttributes(el,attributes,appliedTemplatesAttr){for(var a in attributes)switch(a){case jel.settings.mapKeywords.innerHTML:case jel.settings.mapKeywords.html:jelAddHTML(el,attributes[a]);break;case"style":var tmpAttr;if("string"==typeof attributes[a])null===(tmpAttr=el.getAttribute(a))&&(tmpAttr=""),el.setAttribute(a,(tmpAttr+" "+attributes[a]).trim());else"object"==typeof attributes[a]&&jelSetStyle(el,attributes[a]);break;case"class":var tmpAttr;if("string"==typeof attributes[a])null===(tmpAttr=el.getAttribute(a))&&(tmpAttr=""),el.setAttribute(a,(tmpAttr+" "+attributes[a]).trim());else"object"==typeof attributes[a]&&jelSetClass(el,attributes[a]);break;case jel.settings.mapKeywords.children:case jel.settings.mapKeywords.chi:if("object"==typeof attributes[a])if(Array.isArray(attributes[a]))for(var c in attributes[a])switch(typeof attributes[a][c]){case"object":el.jel(attributes[a][c],{_appliedTemplates:appliedTemplatesAttr});break;case"string":jelAddHTML(el,attributes[a][c]);break;case"function":var res;if(!1===(res=attributes[a][c].call(el,el)))return;res&&el.jel(res,{_appliedTemplates:appliedTemplatesAttr})}else el.jel(attributes[a],{_appliedTemplates:appliedTemplatesAttr});else if("function"==typeof attributes[a]){var res;if(!1===(res=attributes[a].call(el,el)))return;res&&el.jel(res,{_appliedTemplates:appliedTemplatesAttr})}break;case jel.settings.mapKeywords.jel:if("object"==typeof attributes[a])for(var c in attributes[a])switch(c){case"name":el.jelEx._namedParent!==el&&(el.jelEx._namedParent[attributes[a][c]]=el,el.jelEx._namedParentForChildren=el);break;case"root":el.jelEx._componentRoot=el;break;case"links":if("object"!=typeof attributes[a][c])break;for(var p in attributes[a][c])el.jelEx.AddPropertyLink(p,attributes[a][c][p])}break;case"_appliedTemplates":break;default:"function"==typeof attributes[a]?el.setAttribute(a,attributes[a].call(el,el,el.getAttribute(a))):el.setAttribute(a,attributes[a])}}function jelSoftClone(oSrc){var oTrg={};for(var k in oSrc)oTrg[k]=oSrc[k];return oTrg}function jelSoftCloneArray(aSrc){for(var aDest=new Array(aSrc.length),i=0;i<aDest.length;i++)aDest[i]=aSrc[i];return aDest}function jelSoftJoin(oSrc,oToJoin){for(var k in oSrc=oSrc||{},oToJoin=oToJoin||{})oSrc[k]=oToJoin[k];return oSrc}function jelSoftJoinArray(aSrc,aToJoin){aSrc=aSrc||[],aToJoin=aToJoin||[];for(var i=0;i<aToJoin.length;i++)aSrc.push(aToJoin[i]);return aSrc}if(0!==arguments.length){var appliedTemplatesAttr="object"==typeof arguments[arguments.length-1]&&void 0!==arguments[arguments.length-1]._appliedTemplates?jelSoftClone(arguments[arguments.length-1]._appliedTemplates):void 0;if("object"==typeof arguments[0]&&Array.isArray(arguments[0])){var arrEls=[];for(var o in arguments[0]){var newArgs=jelSoftCloneArray(arguments);newArgs[0]=arguments[0][o];var newEl=this.jel.apply(this,newArgs);"undefined"!=newEl&&arrEls.push(newEl)}return arrEls}if("object"==typeof arguments[0]){var tagName=void 0,attrs=void 0;for(var key in arguments[0]){tagName=key,attrs=arguments[0][key];break}return Array.prototype.unshift.call(arguments,tagName),arguments[1]=attrs,this.jel.apply(this,arguments)}if("function"==typeof arguments[0])return arguments[0].call(this);if("string"!=typeof arguments[0])throw"Format error";if("function"==typeof jel._templates[arguments[0]])return jel._templates[arguments[0]].call(this,this,jelSoftCloneArray(arguments));if(jel.settings.allowScripts||"script"!=arguments[0].trim()){var el={};if("object"==typeof jel._templates[arguments[0]]&&(void 0===appliedTemplatesAttr||!0!==appliedTemplatesAttr[arguments[0]])){void 0===appliedTemplatesAttr&&(appliedTemplatesAttr={}),appliedTemplatesAttr[arguments[0]]=!0;var args=jelSoftCloneArray(arguments);return args[0]=jel._templates[arguments[0]],args.push({_appliedTemplates:appliedTemplatesAttr}),el=this.jel.apply(this,args)}if(""!=arguments[0]||"string"!=typeof arguments[1]||2!=arguments.length&&(3!=arguments.length||void 0===appliedTemplatesAttr)){if((el=document.createElement(arguments[0])).jelEx={},el.jelEx._ownerElement=el,el.jelEx._namedParentForChildren=el,el.jelEx._namedParent=el,el.jelEx._componentRoot=el,el.jelEx._topComponentRoot=el,el.jelEx.AddPropertyLink=jelAddPropertyLink,void 0!==this.jelEx&&(el.jelEx._namedParentForChildren=this.jelEx._namedParentForChildren,el.jelEx._namedParent=this.jelEx._namedParentForChildren,el.jelEx._componentRoot=this.jelEx._componentRoot),void 0===el)throw"Unknown error";for(var i=1;i<arguments.length;i++)if("object"==typeof arguments[i]&&("object"==typeof arguments[i][jel.settings.mapKeywords.properties]||"object"==typeof arguments[i][jel.settings.mapKeywords.prop])){var props=arguments[i][jel.settings.mapKeywords.properties]||arguments[i][jel.settings.mapKeywords.prop];for(var p in props){for(var arLocalProp=p.split("."),iterLocal=el,lp=0;lp<arLocalProp.length-1;lp++)void 0===iterLocal[arLocalProp[lp]]&&(iterLocal[arLocalProp[lp]]={}),iterLocal=iterLocal[arLocalProp[lp]];iterLocal[arLocalProp[arLocalProp.length-1]]=props[p]}}for(var i=1;i<arguments.length;i++)switch(typeof arguments[i]){case"string":jelAddHTML(el,arguments[i]);break;case"object":Array.isArray(arguments[i])?jelAddArray(el,arguments[i],appliedTemplatesAttr):jelSetAttributes(el,arguments[i],appliedTemplatesAttr);break;case"function":var res=arguments[i].call(el,el);if(!1===res)return;res&&el.jel(res)}return this.appendChild(el),el}jelAddHTML(this,arguments[1])}}};